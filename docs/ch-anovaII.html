<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Two-way ANOVA | Statistical Methods for Research II</title>
  <meta name="description" content="This file contains code and lecture notes for STA 207" />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Two-way ANOVA | Statistical Methods for Research II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This file contains code and lecture notes for STA 207" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Two-way ANOVA | Statistical Methods for Research II" />
  
  <meta name="twitter:description" content="This file contains code and lecture notes for STA 207" />
  

<meta name="author" content="Shizhe Chen" />


<meta name="date" content="2020-01-31" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-anovaI.html"/>
<link rel="next" href="ch-nested.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STA 207</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="ch-causal.html"><a href="ch-causal.html"><i class="fa fa-check"></i><b>1</b> Causal Inference</a><ul>
<li class="chapter" data-level="1.1" data-path="ch-causal.html"><a href="ch-causal.html#association-and-causality"><i class="fa fa-check"></i><b>1.1</b> Association and Causality</a></li>
<li class="chapter" data-level="1.2" data-path="ch-causal.html"><a href="ch-causal.html#potential-outcomes"><i class="fa fa-check"></i><b>1.2</b> Potential Outcomes</a></li>
<li class="chapter" data-level="1.3" data-path="ch-causal.html"><a href="ch-causal.html#experiments-v.s.-observational-studies"><i class="fa fa-check"></i><b>1.3</b> Experiments v.s. Observational Studies</a></li>
<li class="chapter" data-level="1.4" data-path="ch-causal.html"><a href="ch-causal.html#learning-objectives"><i class="fa fa-check"></i><b>1.4</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-anovaI.html"><a href="ch-anovaI.html"><i class="fa fa-check"></i><b>2</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="2.1" data-path="ch-anovaI.html"><a href="ch-anovaI.html#simple-randomized-experiments"><i class="fa fa-check"></i><b>2.1</b> Simple randomized experiments</a></li>
<li class="chapter" data-level="2.2" data-path="ch-anovaI.html"><a href="ch-anovaI.html#one-way-anova"><i class="fa fa-check"></i><b>2.2</b> One-way ANOVA</a><ul>
<li class="chapter" data-level="2.2.1" data-path="ch-anovaI.html"><a href="ch-anovaI.html#a-motivating-example-the-spock-trial"><i class="fa fa-check"></i><b>2.2.1</b> A motivating example: the Spock trial</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch-anovaI.html"><a href="ch-anovaI.html#anova-model"><i class="fa fa-check"></i><b>2.2.2</b> ANOVA model</a></li>
<li class="chapter" data-level="2.2.3" data-path="ch-anovaI.html"><a href="ch-anovaI.html#statistical-inference"><i class="fa fa-check"></i><b>2.2.3</b> Statistical inference</a></li>
<li class="chapter" data-level="2.2.4" data-path="ch-anovaI.html"><a href="ch-anovaI.html#alternative-forms-of-the-anova-model"><i class="fa fa-check"></i><b>2.2.4</b> Alternative forms of the ANOVA model</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-anovaI.html"><a href="ch-anovaI.html#model-diagnostics"><i class="fa fa-check"></i><b>2.3</b> Model diagnostics</a></li>
<li class="chapter" data-level="2.4" data-path="ch-anovaI.html"><a href="ch-anovaI.html#learning-objectives-1"><i class="fa fa-check"></i><b>2.4</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-anovaII.html"><a href="ch-anovaII.html"><i class="fa fa-check"></i><b>3</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="3.1" data-path="ch-anovaII.html"><a href="ch-anovaII.html#experiments-with-two-or-more-factors"><i class="fa fa-check"></i><b>3.1</b> Experiments with two (or more) factors</a></li>
<li class="chapter" data-level="3.2" data-path="ch-anovaII.html"><a href="ch-anovaII.html#two-way-anova"><i class="fa fa-check"></i><b>3.2</b> Two-way ANOVA</a><ul>
<li class="chapter" data-level="3.2.1" data-path="ch-anovaII.html"><a href="ch-anovaII.html#a-motivating-example-hey-fever-relief-data-set"><i class="fa fa-check"></i><b>3.2.1</b> A motivating example: Hey fever relief data set</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch-anovaII.html"><a href="ch-anovaII.html#a-two-way-anova-model"><i class="fa fa-check"></i><b>3.2.2</b> A two-way ANOVA model</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch-anovaII.html"><a href="ch-anovaII.html#statistical-inference-1"><i class="fa fa-check"></i><b>3.2.3</b> Statistical inference</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch-anovaII.html"><a href="ch-anovaII.html#model-diagnostics-1"><i class="fa fa-check"></i><b>3.2.4</b> Model diagnostics</a></li>
<li class="chapter" data-level="3.2.5" data-path="ch-anovaII.html"><a href="ch-anovaII.html#strategy-for-data-analysis"><i class="fa fa-check"></i><b>3.2.5</b> Strategy for data analysis</a></li>
<li class="chapter" data-level="3.2.6" data-path="ch-anovaII.html"><a href="ch-anovaII.html#special-case-one-observation-per-cell"><i class="fa fa-check"></i><b>3.2.6</b> Special case: one observation per cell</a></li>
<li class="chapter" data-level="3.2.7" data-path="ch-anovaII.html"><a href="ch-anovaII.html#unbalanced-two-way-anova"><i class="fa fa-check"></i><b>3.2.7</b> Unbalanced two-way ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-anovaII.html"><a href="ch-anovaII.html#learning-objectives-2"><i class="fa fa-check"></i><b>3.3</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-nested.html"><a href="ch-nested.html"><i class="fa fa-check"></i><b>4</b> Random and Mixed Effect Models</a><ul>
<li class="chapter" data-level="4.1" data-path="ch-nested.html"><a href="ch-nested.html#nested-design"><i class="fa fa-check"></i><b>4.1</b> Nested design</a></li>
<li class="chapter" data-level="4.2" data-path="ch-nested.html"><a href="ch-nested.html#random-effects-model"><i class="fa fa-check"></i><b>4.2</b> Random effects model</a></li>
<li class="chapter" data-level="4.3" data-path="ch-nested.html"><a href="ch-nested.html#learning-objectives-3"><i class="fa fa-check"></i><b>4.3</b> Learning Objectives</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-repeated.html"><a href="ch-repeated.html"><i class="fa fa-check"></i><b>5</b> Repeated Measures Design</a><ul>
<li class="chapter" data-level="5.1" data-path="ch-repeated.html"><a href="ch-repeated.html#repeated-measures-design"><i class="fa fa-check"></i><b>5.1</b> Repeated measures design</a></li>
<li class="chapter" data-level="5.2" data-path="ch-repeated.html"><a href="ch-repeated.html#analysis-of-repeated-measures-designs"><i class="fa fa-check"></i><b>5.2</b> Analysis of repeated measures designs</a><ul>
<li class="chapter" data-level="5.2.1" data-path="ch-repeated.html"><a href="ch-repeated.html#two-way-anova-model"><i class="fa fa-check"></i><b>5.2.1</b> Two-way ANOVA model</a></li>
<li class="chapter" data-level="5.2.2" data-path="ch-repeated.html"><a href="ch-repeated.html#more-complicated-repeated-measures-design"><i class="fa fa-check"></i><b>5.2.2</b> More complicated repeated measures design</a></li>
<li class="chapter" data-level="5.2.3" data-path="ch-repeated.html"><a href="ch-repeated.html#longitudinal-data-analysis"><i class="fa fa-check"></i><b>5.2.3</b> Longitudinal data analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-case.html"><a href="ch-case.html"><i class="fa fa-check"></i><b>6</b> Case-control Study</a><ul>
<li class="chapter" data-level="6.1" data-path="ch-case.html"><a href="ch-case.html#case-control-study"><i class="fa fa-check"></i><b>6.1</b> Case-control study</a></li>
<li class="chapter" data-level="6.2" data-path="ch-case.html"><a href="ch-case.html#logistic-regression"><i class="fa fa-check"></i><b>6.2</b> Logistic regression</a></li>
<li class="chapter" data-level="6.3" data-path="ch-case.html"><a href="ch-case.html#generalized-linear-model"><i class="fa fa-check"></i><b>6.3</b> Generalized linear model</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-obs.html"><a href="ch-obs.html"><i class="fa fa-check"></i><b>7</b> Observational Study</a><ul>
<li class="chapter" data-level="7.1" data-path="ch-obs.html"><a href="ch-obs.html#causality-in-observational-studies"><i class="fa fa-check"></i><b>7.1</b> Causality in observational studies</a></li>
<li class="chapter" data-level="7.2" data-path="ch-obs.html"><a href="ch-obs.html#analysis-with-no-latent-confouding"><i class="fa fa-check"></i><b>7.2</b> Analysis with no latent confouding</a></li>
<li class="chapter" data-level="7.3" data-path="ch-obs.html"><a href="ch-obs.html#instrumental-variable"><i class="fa fa-check"></i><b>7.3</b> Instrumental variable</a></li>
<li class="chapter" data-level="7.4" data-path="ch-obs.html"><a href="ch-obs.html#missing-data"><i class="fa fa-check"></i><b>7.4</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-dim.html"><a href="ch-dim.html"><i class="fa fa-check"></i><b>8</b> Complex data</a><ul>
<li class="chapter" data-level="8.1" data-path="ch-dim.html"><a href="ch-dim.html#data-in-the-big-data-era"><i class="fa fa-check"></i><b>8.1</b> Data in the big data era</a></li>
<li class="chapter" data-level="8.2" data-path="ch-dim.html"><a href="ch-dim.html#useful-methods"><i class="fa fa-check"></i><b>8.2</b> Useful methods</a><ul>
<li class="chapter" data-level="8.2.1" data-path="ch-dim.html"><a href="ch-dim.html#penalized-regression"><i class="fa fa-check"></i><b>8.2.1</b> Penalized regression</a></li>
<li class="chapter" data-level="8.2.2" data-path="ch-dim.html"><a href="ch-dim.html#model-selection"><i class="fa fa-check"></i><b>8.2.2</b> Model selection</a></li>
<li class="chapter" data-level="8.2.3" data-path="ch-dim.html"><a href="ch-dim.html#other"><i class="fa fa-check"></i><b>8.2.3</b> Other</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-proj.html"><a href="ch-proj.html"><i class="fa fa-check"></i><b>9</b> Project description</a><ul>
<li class="chapter" data-level="9.1" data-path="ch-proj.html"><a href="ch-proj.html#project-1-project-star-i"><i class="fa fa-check"></i><b>9.1</b> Project 1: Project STAR I</a><ul>
<li class="chapter" data-level="9.1.1" data-path="ch-proj.html"><a href="ch-proj.html#background"><i class="fa fa-check"></i><b>9.1.1</b> Background</a></li>
<li class="chapter" data-level="9.1.2" data-path="ch-proj.html"><a href="ch-proj.html#tasks"><i class="fa fa-check"></i><b>9.1.2</b> Tasks</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch-proj.html"><a href="ch-proj.html#project-2-project-star-ii"><i class="fa fa-check"></i><b>9.2</b> Project 2: Project STAR II</a></li>
<li class="chapter" data-level="9.3" data-path="ch-proj.html"><a href="ch-proj.html#background-1"><i class="fa fa-check"></i><b>9.3</b> Background</a></li>
<li class="chapter" data-level="9.4" data-path="ch-proj.html"><a href="ch-proj.html#tasks-1"><i class="fa fa-check"></i><b>9.4</b> Tasks</a></li>
<li class="chapter" data-level="9.5" data-path="ch-proj.html"><a href="ch-proj.html#project-3-us-traffic-fatalities"><i class="fa fa-check"></i><b>9.5</b> Project 3: US Traffic Fatalities</a></li>
<li class="chapter" data-level="9.6" data-path="ch-proj.html"><a href="ch-proj.html#background-2"><i class="fa fa-check"></i><b>9.6</b> Background</a></li>
<li class="chapter" data-level="9.7" data-path="ch-proj.html"><a href="ch-proj.html#tasks-2"><i class="fa fa-check"></i><b>9.7</b> Tasks</a></li>
<li class="chapter" data-level="9.8" data-path="ch-proj.html"><a href="ch-proj.html#hints"><i class="fa fa-check"></i><b>9.8</b> Hints</a></li>
<li class="chapter" data-level="9.9" data-path="ch-proj.html"><a href="ch-proj.html#project-4-bank-marketing"><i class="fa fa-check"></i><b>9.9</b> Project 4: Bank Marketing</a></li>
<li class="chapter" data-level="9.10" data-path="ch-proj.html"><a href="ch-proj.html#background-3"><i class="fa fa-check"></i><b>9.10</b> Background</a></li>
<li class="chapter" data-level="9.11" data-path="ch-proj.html"><a href="ch-proj.html#tasks-3"><i class="fa fa-check"></i><b>9.11</b> Tasks</a></li>
<li class="chapter" data-level="9.12" data-path="ch-proj.html"><a href="ch-proj.html#hints-1"><i class="fa fa-check"></i><b>9.12</b> Hints</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Methods for Research II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch:anovaII" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Two-way ANOVA</h1>
<div id="experiments-with-two-or-more-factors" class="section level2">
<h2><span class="header-section-number">3.1</span> Experiments with two (or more) factors</h2>
<ul>
<li>Randomized experiments with two treatments</li>
<li>Stratified randomized Experiments (also known as randomized block design)
<ul>
<li>Auditor training data</li>
<li>Project STAR</li>
</ul></li>
<li>Reasons for stratification: practical and statistical</li>
<li>Sampling scheme for a stratified randomized experiment</li>
<li>Question of interest, null hypotheses, and their causal interpretation.</li>
<li>Intuition of hypothesis testing.</li>
</ul>
<p><strong>Auditor training</strong></p>
<p>We can check whether stratification is efficient on the auditor training data.</p>
<p>Description of the auditor training data: There are three training methods for the auditors and the response <span class="math inline">\(Y\)</span> is a proficiency score after the training are completed. Ideally we would like to compare the three methods among those who are as similar as possible in their educational background. How do we achieve this? One way is compare the three different training methods among those whose time since graduation from college are about the same. Suppose then we have ten such groups (of three individuals each). Group 1 consists of those who graduated recently, group 2 people graduated between one and two years ago, and group 10 consists of those who graduated some time in the past (say, ten years or more). Time since graduation is called the block (or a blocking factor) and treatment is the training method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Audit &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;./data/AuditorTraining.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)

<span class="co"># Draw the interaction plot:</span>
<span class="kw">interaction.plot</span>(Audit<span class="op">$</span>Block, Audit<span class="op">$</span>Method,Audit<span class="op">$</span>Proficiency)</code></pre></div>
<p><img src="STA207_bookdown_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit the model with blocks:</span>
anova.block&lt;-<span class="kw">aov</span>(Proficiency<span class="op">~</span><span class="kw">as.factor</span>(Block)<span class="op">+</span><span class="kw">as.factor</span>(Method),<span class="dt">data=</span>Audit)
anova.random&lt;-<span class="kw">aov</span>(Proficiency<span class="op">~</span><span class="kw">as.factor</span>(Method),<span class="dt">data=</span>Audit)

mse.block&lt;-<span class="kw">sum</span>(anova.block<span class="op">$</span>residuals<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>anova.block<span class="op">$</span>df.residual
mse.random&lt;-<span class="kw">sum</span>(anova.random<span class="op">$</span>residuals<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>anova.random<span class="op">$</span>df.residual
(<span class="dt">E=</span>mse.random<span class="op">/</span>mse.block)</code></pre></div>
<pre><code>## [1] 3.2</code></pre>
<p><strong>Simulation</strong></p>
<p>We can also explore the properties of blocking using simulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># A simple simulation for stratification </span>
<span class="kw">set.seed</span>(<span class="dv">10928</span>)
<span class="co"># Data generating mechanism: </span>
n=<span class="dv">40</span>;n.strata=<span class="dv">10</span>;
X=<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>(<span class="dv">1</span><span class="op">:</span>n.strata),<span class="dt">size=</span>n,<span class="dt">replace=</span><span class="ot">TRUE</span>);
ACE=<span class="dv">4</span>; coef.X=<span class="dv">2</span>; 
Y.<span class="dv">1</span>=ACE<span class="op">+</span>coef.X<span class="op">*</span>X<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>); <span class="co"># potential outcome</span>
Y.<span class="dv">0</span>=coef.X<span class="op">*</span>X<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>); <span class="co"># potential outcome </span>
trt=<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,<span class="dt">size=</span>(n<span class="op">/</span><span class="dv">2</span>),<span class="dt">replace=</span><span class="ot">FALSE</span>);Z=<span class="kw">rep</span>(<span class="dv">0</span>,n);Z[trt]=<span class="dv">1</span>; <span class="co"># randomization</span>

Z.s=<span class="kw">rep</span>(<span class="dv">0</span>,n);
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n.strata){<span class="co"># randomization within stratum </span>
  id.stratum=<span class="st"> </span><span class="kw">which</span>(X<span class="op">==</span>i);
  trt=<span class="st"> </span><span class="kw">sample</span>(id.stratum,<span class="dt">size=</span><span class="kw">floor</span>(<span class="kw">length</span>(id.stratum)<span class="op">/</span><span class="dv">2</span>),<span class="dt">replace=</span><span class="ot">FALSE</span>);
  Z.s[trt]=<span class="dv">1</span>; 
}

Y=Y.<span class="dv">1</span><span class="op">*</span>Z<span class="op">+</span>Y.<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Z); <span class="co"># observation w/o stratification </span>
Y.s=Y.<span class="dv">1</span><span class="op">*</span>Z.s<span class="op">+</span>Y.<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Z.s); <span class="co"># observation w stratification </span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Analysis, w/o stratification </span>

lm.vanilla=<span class="kw">summary</span>(<span class="kw">lm</span>(Y<span class="op">~</span>Z));
lm.X=<span class="kw">summary</span>(<span class="kw">lm</span>(Y<span class="op">~</span>Z<span class="op">+</span>X));

<span class="kw">plot</span>(<span class="dt">y=</span>Y,<span class="dt">x=</span>X,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>)[Z<span class="op">+</span><span class="dv">1</span>])
<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">1.1</span>,<span class="dt">y=</span><span class="dv">22</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;Trt&#39;</span>,<span class="st">&#39;Ctrl&#39;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>),<span class="dt">pch=</span><span class="dv">16</span>)
<span class="kw">text</span>(<span class="dt">x=</span><span class="fl">5.1</span>,<span class="dt">y=</span><span class="dv">5</span>,<span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&#39;Without X, Est. ACE = &#39;</span>,<span class="kw">round</span>(lm.vanilla<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dv">2</span>), <span class="st">&#39;with s.e.&#39;</span>, <span class="kw">round</span>(lm.vanilla<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dv">2</span>),<span class="dt">sep=</span><span class="st">&#39; &#39;</span>  ),<span class="dt">pos=</span><span class="dv">4</span>  )

<span class="kw">text</span>(<span class="dt">x=</span><span class="fl">5.1</span>,<span class="dt">y=</span><span class="dv">2</span>,<span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&#39;With X,  Est. ACE = &#39;</span>,<span class="kw">round</span>(lm.X<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dv">2</span>), <span class="st">&#39;with s.e.&#39;</span>, <span class="kw">round</span>(lm.X<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dv">2</span>),<span class="dt">sep=</span><span class="st">&#39; &#39;</span>  ),<span class="dt">pos=</span><span class="dv">4</span>  )</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig-nostrat"></span>
<img src="STA207_bookdown_files/figure-html/fig-nostrat-1.png" alt="Estimation of ACE with and without adjusting for X" width="80%" />
<p class="caption">
Figure 3.1: Estimation of ACE with and without adjusting for X
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Analysis, w/o stratification </span>

lm.simple=<span class="kw">summary</span>(<span class="kw">lm</span>(Y.s<span class="op">~</span>Z.s));
lm.strat=<span class="kw">summary</span>(<span class="kw">lm</span>(Y.s<span class="op">~</span>Z.s<span class="op">+</span>X));

<span class="kw">plot</span>(<span class="dt">y=</span>Y.s,<span class="dt">x=</span>X,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>)[Z<span class="op">+</span><span class="dv">1</span>])
<span class="kw">legend</span>(<span class="dt">x=</span><span class="fl">1.1</span>,<span class="dt">y=</span><span class="dv">22</span>,<span class="dt">legend=</span><span class="kw">c</span>(<span class="st">&#39;Trt&#39;</span>,<span class="st">&#39;Ctrl&#39;</span>),<span class="dt">col=</span><span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>),<span class="dt">pch=</span><span class="dv">16</span>)
<span class="kw">text</span>(<span class="dt">x=</span><span class="fl">5.1</span>,<span class="dt">y=</span><span class="dv">5</span>,<span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&#39;Without X, Est. ACE = &#39;</span>,<span class="kw">round</span>(lm.simple<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dv">2</span>), <span class="st">&#39;with s.e.&#39;</span>, <span class="kw">round</span>(lm.simple<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dv">2</span>),<span class="dt">sep=</span><span class="st">&#39; &#39;</span>  ),<span class="dt">pos=</span><span class="dv">4</span>  )

<span class="kw">text</span>(<span class="dt">x=</span><span class="fl">5.1</span>,<span class="dt">y=</span><span class="dv">2</span>,<span class="dt">labels=</span><span class="kw">paste</span>(<span class="st">&#39;With X,  Est. ACE = &#39;</span>,<span class="kw">round</span>(lm.strat<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>],<span class="dv">2</span>), <span class="st">&#39;with s.e.&#39;</span>, <span class="kw">round</span>(lm.strat<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">2</span>],<span class="dv">2</span>),<span class="dt">sep=</span><span class="st">&#39; &#39;</span>  ),<span class="dt">pos=</span><span class="dv">4</span>  )</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig-strat"></span>
<img src="STA207_bookdown_files/figure-html/fig-strat-1.png" alt="Estimation of ACE with and without adjusting for X under stratified randomization" width="80%" />
<p class="caption">
Figure 3.2: Estimation of ACE with and without adjusting for X under stratified randomization
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Repeat the above procedure 10000 times to evaluate the efficiency </span>

<span class="co"># Wrap up the code in one function </span>

strat.sim&lt;-<span class="cf">function</span>(ACE){ 
n=<span class="dv">40</span>;n.strata=<span class="dv">10</span>;
X=<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x=</span>(<span class="dv">1</span><span class="op">:</span>n.strata),<span class="dt">size=</span>n,<span class="dt">replace=</span><span class="ot">TRUE</span>);
 coef.X=<span class="dv">5</span>; 
Y.<span class="dv">1</span>=ACE<span class="op">+</span>coef.X<span class="op">*</span>X<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>); <span class="co"># potential outcome</span>
Y.<span class="dv">0</span>=coef.X<span class="op">*</span>X<span class="op">+</span><span class="kw">rnorm</span>(n,<span class="dt">mean=</span><span class="dv">0</span>,<span class="dt">sd=</span><span class="dv">1</span>); <span class="co"># potential outcome </span>
trt=<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n,<span class="dt">size=</span>(n<span class="op">/</span><span class="dv">2</span>),<span class="dt">replace=</span><span class="ot">FALSE</span>);Z=<span class="kw">rep</span>(<span class="dv">0</span>,n);Z[trt]=<span class="dv">1</span>; <span class="co"># randomization</span>

Z.s=<span class="kw">rep</span>(<span class="dv">0</span>,n);
<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n.strata){<span class="co"># randomization within stratum </span>
  id.stratum=<span class="st"> </span><span class="kw">which</span>(X<span class="op">==</span>i);
  trt=<span class="st"> </span><span class="kw">sample</span>(id.stratum,<span class="dt">size=</span><span class="kw">floor</span>(<span class="kw">length</span>(id.stratum)<span class="op">/</span><span class="dv">2</span>),<span class="dt">replace=</span><span class="ot">FALSE</span>);
  Z.s[trt]=<span class="dv">1</span>; 
}

Y=Y.<span class="dv">1</span><span class="op">*</span>Z<span class="op">+</span>Y.<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Z); <span class="co"># observation w/o stratification </span>
Y.s=Y.<span class="dv">1</span><span class="op">*</span>Z.s<span class="op">+</span>Y.<span class="dv">0</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>Z.s); <span class="co"># observation w stratification </span>


lm.vanilla=<span class="kw">summary</span>(<span class="kw">lm</span>(Y<span class="op">~</span>Z));
lm.X=<span class="kw">summary</span>(<span class="kw">lm</span>(Y<span class="op">~</span>Z<span class="op">+</span>X));

lm.simple=<span class="kw">summary</span>(<span class="kw">lm</span>(Y.s<span class="op">~</span>Z.s));
lm.strat=<span class="kw">summary</span>(<span class="kw">lm</span>(Y.s<span class="op">~</span>Z.s<span class="op">+</span>X));

est.ACE=<span class="kw">c</span>(lm.vanilla<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>],lm.X<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>],lm.simple<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>],lm.strat<span class="op">$</span>coef[<span class="dv">2</span>,<span class="dv">1</span>])
<span class="kw">return</span>(est.ACE)
}
ACE=<span class="dv">4</span>;

sim.result=<span class="kw">replicate</span>(<span class="dt">n=</span><span class="fl">1e4</span>,<span class="kw">strat.sim</span>(<span class="dt">ACE=</span>ACE));</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">mse=</span><span class="kw">apply</span>(sim.result<span class="op">-</span>ACE,<span class="dt">MARGIN=</span><span class="dv">1</span>,sd))</code></pre></div>
<pre><code>## [1] 4.59 0.32 1.36 0.32</code></pre>
<p>Q: Why conducting stratify randomization given the simulation results?</p>
<p>For more discussion, see Chapters 6 and 8 in <a href="https://stat.ethz.ch/~meier/teaching/anova/">ANOVA: A Short Intro Using R</a> by Lukas Meier.</p>
</div>
<div id="two-way-anova" class="section level2">
<h2><span class="header-section-number">3.2</span> Two-way ANOVA</h2>
<div id="a-motivating-example-hey-fever-relief-data-set" class="section level3">
<h3><span class="header-section-number">3.2.1</span> A motivating example: Hey fever relief data set</h3>
<p>For the Hay Fever Relief example, 9 compounds for Hay Fever Relief are made by varying levels of the two basic ingredients. Ingredient 1 (factor A) has <span class="math inline">\(a = 3\)</span> levels: low <span class="math inline">\((i = 1)\)</span>, medium <span class="math inline">\((i = 2)\)</span> and high <span class="math inline">\((i = 3)\)</span>. Similarly, ingredient 2 (factor B) has <span class="math inline">\(b = 3\)</span> levels: low <span class="math inline">\((j = 1)\)</span>, medium <span class="math inline">\((j = 2)\)</span> and high <span class="math inline">\((j = 3)\)</span>. A total of 36 subjects (suffering from hay fever) are selected and each of the 9 compounds are given to randomly selected <span class="math inline">\(n = 4\)</span> individuals.</p>
</div>
<div id="a-two-way-anova-model" class="section level3">
<h3><span class="header-section-number">3.2.2</span> A two-way ANOVA model</h3>
<ul>
<li>Cell mean model</li>
<li>Decomposition of the means, and their estimators</li>
<li>Additive models
<ul>
<li>Why additive models?</li>
<li>Estimators of the means</li>
</ul></li>
<li>Decomposition of sum of squares, and their properties</li>
</ul>
</div>
<div id="statistical-inference-1" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Statistical inference</h3>
<ul>
<li>F-statistics based on sums of squares</li>
<li>Hypothesis testing
<ul>
<li>Test for interaction effects</li>
<li>Test for main effects</li>
<li>Alternative test if interaction can be ignored (additive models)</li>
</ul></li>
<li>(Simultaneous) confidence intervals with and without interactions
<ul>
<li>Bonferroni</li>
<li>Tukey</li>
<li>Scheffe</li>
</ul></li>
</ul>
</div>
<div id="model-diagnostics-1" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Model diagnostics</h3>
<ul>
<li>Similar to those for one-way ANOVA</li>
</ul>
</div>
<div id="strategy-for-data-analysis" class="section level3">
<h3><span class="header-section-number">3.2.5</span> Strategy for data analysis</h3>
<p>Using the Hey Fever data as an example.</p>
<p>Step 0. Exploratory data analysis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Hay &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;./data/HayFever.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)

<span class="co"># Use a slightly different visualization:</span>
<span class="kw">pairs</span>(Hay,<span class="dt">pch=</span><span class="dv">16</span>,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>,<span class="dt">cex=</span><span class="fl">1.5</span>)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig-anovaII"></span>
<img src="STA207_bookdown_files/figure-html/fig-anovaII-1.png" alt="Box plot with jittered data points for the Hay Fever data." width="80%" />
<p class="caption">
Figure 3.3: Box plot with jittered data points for the Hay Fever data.
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Or draw the main effect plots </span>
<span class="kw">plotmeans</span>(Relief<span class="op">~</span>Ingredient.<span class="dv">1</span>,<span class="dt">data=</span>Hay,<span class="dt">xlab=</span><span class="st">&quot;Ingredient 1&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Relief&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Main  effect, Ingredient 1&quot;</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig-anovaII-m1"></span>
<img src="STA207_bookdown_files/figure-html/fig-anovaII-m1-1.png" alt="Main effect plot for ingredient 1" width="80%" />
<p class="caption">
Figure 3.4: Main effect plot for ingredient 1
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotmeans</span>(Relief<span class="op">~</span>Ingredient.<span class="dv">2</span>,<span class="dt">data=</span>Hay,<span class="dt">xlab=</span><span class="st">&quot;Ingredient 2&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Relief&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Main  effect, Ingredient 1&quot;</span>) </code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig-anovaII-m2"></span>
<img src="STA207_bookdown_files/figure-html/fig-anovaII-m2-1.png" alt="Main effect plot for ingredient 2" width="80%" />
<p class="caption">
Figure 3.5: Main effect plot for ingredient 2
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">interaction.plot</span>(Hay<span class="op">$</span>Ingredient.<span class="dv">1</span>, Hay<span class="op">$</span>Ingredient.<span class="dv">2</span>, Hay<span class="op">$</span>Relief)</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:fig-anovaII-i"></span>
<img src="STA207_bookdown_files/figure-html/fig-anovaII-i-1.png" alt="Interaction plot" width="80%" />
<p class="caption">
Figure 3.6: Interaction plot
</p>
</div>
<p>Step 1. Test whether interaction effects are presented.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We can use the regression form here</span>
full_model=<span class="kw">lm</span>(Relief<span class="op">~</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">1</span>)<span class="op">+</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">2</span>)<span class="op">+</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">1</span>)<span class="op">*</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">2</span>),<span class="dt">data=</span>Hay);
reduced_model=<span class="kw">lm</span>(Relief<span class="op">~</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">1</span>)<span class="op">+</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">2</span>),<span class="dt">data=</span>Hay);
<span class="kw">anova</span>(reduced_model,full_model)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Model 1: Relief ~ as.factor(Ingredient.1) + as.factor(Ingredient.2)
## Model 2: Relief ~ as.factor(Ingredient.1) + as.factor(Ingredient.2) + 
##     as.factor(Ingredient.1) * as.factor(Ingredient.2)
##   Res.Df   RSS Df Sum of Sq   F Pr(&gt;F)    
## 1     31 31.05                            
## 2     27  1.63  4      29.4 122 &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The test result show that interaction effects are very unlikely to be absent from this data set. This means that we need to treat each combination as a unit, whereas we can compare each type of main effects separately. In the Hay Fever data, we naturally want to the find the combination of ingredients that is most effective. We can use the Tukey-Kramer method for this task.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(stats)
alpha=<span class="fl">0.05</span>;
anova.fit&lt;-<span class="kw">aov</span>(Relief<span class="op">~</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">1</span>)<span class="op">+</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">2</span>)<span class="op">+</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">1</span>)<span class="op">*</span><span class="kw">as.factor</span>(Ingredient.<span class="dv">2</span>),<span class="dt">data=</span>Hay)
T.ci=<span class="kw">TukeyHSD</span>(anova.fit,<span class="dt">conf.level =</span> <span class="dv">1</span><span class="op">-</span>alpha)
<span class="kw">plot</span>(T.ci, <span class="dt">las=</span><span class="dv">1</span> , <span class="dt">col=</span><span class="st">&quot;brown&quot;</span>)</code></pre></div>
<p><img src="STA207_bookdown_files/figure-html/unnamed-chunk-17-1.png" width="672" /><img src="STA207_bookdown_files/figure-html/unnamed-chunk-17-2.png" width="672" /><img src="STA207_bookdown_files/figure-html/unnamed-chunk-17-3.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># We only need to pay attention to the differences of the two largest means</span>
idx=<span class="kw">list</span>();
idx[[<span class="dv">1</span>]]=Hay<span class="op">$</span>Ingredient.<span class="dv">1</span>;idx[[<span class="dv">2</span>]]=Hay<span class="op">$</span>Ingredient.<span class="dv">2</span>;
(<span class="dt">means.comb=</span><span class="kw">tapply</span>( Hay<span class="op">$</span>Relief, <span class="dt">INDEX=</span>idx,mean))</code></pre></div>
<pre><code>##     1    2    3
## 1 2.5  4.6  4.6
## 2 5.4  8.9  9.1
## 3 6.0 10.3 13.2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># For model diagnostics, we can use the default plotting function of aov()</span>

<span class="kw">plot</span>(anova.fit)</code></pre></div>
<p><img src="STA207_bookdown_files/figure-html/unnamed-chunk-18-1.png" width="672" /><img src="STA207_bookdown_files/figure-html/unnamed-chunk-18-2.png" width="672" /><img src="STA207_bookdown_files/figure-html/unnamed-chunk-18-3.png" width="672" /><img src="STA207_bookdown_files/figure-html/unnamed-chunk-18-4.png" width="672" /></p>
</div>
<div id="special-case-one-observation-per-cell" class="section level3">
<h3><span class="header-section-number">3.2.6</span> Special case: one observation per cell</h3>
<ul>
<li>Interaction effects are no longer identifiable</li>
<li>Estimation and testing</li>
<li>Tukey’s test of additivity</li>
</ul>
</div>
<div id="unbalanced-two-way-anova" class="section level3">
<h3><span class="header-section-number">3.2.7</span> Unbalanced two-way ANOVA</h3>
<ul>
<li>The model is the same as for the balanced case</li>
<li>Estimators for the means and variances</li>
<li>Hypothesis testing
<ul>
<li>Interaction effects</li>
<li>Main effects</li>
</ul></li>
<li>Missing data in the one observation per cell case</li>
</ul>
</div>
</div>
<div id="learning-objectives-2" class="section level2">
<h2><span class="header-section-number">3.3</span> Learning Objectives</h2>
<ul>
<li>Students are able to write down an appropriate two-way ANOVA model given a new dataset.</li>
<li>Students understand the basic properties of the various types of two-way ANOVA models.</li>
<li>Students recognize the assumptions associated with each method, and can find appropriate tests to verify the assumptions.</li>
<li>Students can implement the aforemened tasks in <code>R</code>.</li>
<li>Students can seek help in coding using the Internet.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-anovaI.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-nested.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["STA207_bookdown.pdf", "STA207_bookdown.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
